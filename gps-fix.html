<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPSä¿®å¾©æ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .test-card { background: white; padding: 20px; border-radius: 8px; margin: 10px 0; }
        button { padding: 15px 25px; font-size: 16px; border: none; border-radius: 8px; cursor: pointer; margin: 5px; }
        .gps-btn { background: #28a745; color: white; }
        .sensor-btn { background: #007bff; color: white; }
        .result { margin: 10px 0; padding: 15px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border-left: 4px solid #28a745; }
        .error { background: #f8d7da; color: #721c24; border-left: 4px solid #dc3545; }
        .info { background: #d1ecf1; color: #0c5460; border-left: 4px solid #17a2b8; }
    </style>
</head>
<body>
    <h1>ğŸ”§ GPSå’Œæ„Ÿæ‡‰å™¨ä¿®å¾©æ¸¬è©¦</h1>
    
    <div class="test-card">
        <h2>ğŸ“ GPSæ¸¬è©¦</h2>
        <button class="gps-btn" onclick="testGPS()">æ¸¬è©¦GPSæ¬Šé™</button>
        <div id="gps-result" class="result" style="display: none;"></div>
    </div>
    
    <div class="test-card">
        <h2>ğŸ“± æ„Ÿæ‡‰å™¨æ¸¬è©¦</h2>
        <button class="sensor-btn" onclick="testSensor()">æ¸¬è©¦æ„Ÿæ‡‰å™¨æ¬Šé™</button>
        <div id="sensor-result" class="result" style="display: none;"></div>
    </div>
    
    <div class="test-card">
        <h2>ğŸ” èª¿è©¦ä¿¡æ¯</h2>
        <div id="debug-info" class="info"></div>
    </div>

    <script>
        function showResult(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.textContent = message;
            element.className = `result ${type}`;
        }
        
        function testGPS() {
            console.log('é–‹å§‹GPSæ¸¬è©¦...');
            showResult('gps-result', 'æ­£åœ¨æ¸¬è©¦GPS...', 'info');
            
            if (!navigator.geolocation) {
                showResult('gps-result', 'âŒ ç€è¦½å™¨ä¸æ”¯æ´GPS', 'error');
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    console.log('GPSæˆåŠŸ:', position);
                    const msg = `âœ… GPSæˆåŠŸï¼\nç·¯åº¦: ${position.coords.latitude}\nç¶“åº¦: ${position.coords.longitude}\nç²¾åº¦: ${position.coords.accuracy}ç±³`;
                    showResult('gps-result', msg, 'success');
                },
                function(error) {
                    console.log('GPSå¤±æ•—:', error);
                    let msg = 'âŒ GPSå¤±æ•—: ';
                    if (error.code === 1) {
                        msg += 'æ¬Šé™è¢«æ‹’çµ• - è«‹åœ¨ç€è¦½å™¨ä¸­å…è¨±ä½ç½®æ¬Šé™';
                    } else if (error.code === 2) {
                        msg += 'ä½ç½®ä¸å¯ç”¨ - è«‹æª¢æŸ¥GPSè¨­å®š';
                    } else if (error.code === 3) {
                        msg += 'å®šä½è¶…æ™‚ - è«‹é‡è©¦';
                    } else {
                        msg += error.message;
                    }
                    showResult('gps-result', msg, 'error');
                },
                { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
            );
        }
        
        function testSensor() {
            console.log('é–‹å§‹æ„Ÿæ‡‰å™¨æ¸¬è©¦...');
            showResult('sensor-result', 'æ­£åœ¨æ¸¬è©¦æ„Ÿæ‡‰å™¨...', 'info');
            
            if (typeof DeviceMotionEvent !== "undefined" && typeof DeviceMotionEvent.requestPermission === "function") {
                console.log('éœ€è¦è«‹æ±‚æ„Ÿæ‡‰å™¨æ¬Šé™...');
                DeviceMotionEvent.requestPermission().then(response => {
                    console.log('æ„Ÿæ‡‰å™¨æ¬Šé™çµæœ:', response);
                    if (response === "granted") {
                        showResult('sensor-result', 'âœ… æ„Ÿæ‡‰å™¨æ¬Šé™å·²å…è¨±', 'success');
                        startSensorListen();
                    } else {
                        showResult('sensor-result', 'âŒ æ„Ÿæ‡‰å™¨æ¬Šé™è¢«æ‹’çµ•', 'error');
                    }
                }).catch(error => {
                    console.log('æ„Ÿæ‡‰å™¨æ¬Šé™éŒ¯èª¤:', error);
                    showResult('sensor-result', 'âŒ æ„Ÿæ‡‰å™¨æ¬Šé™è«‹æ±‚å¤±æ•—: ' + error.message, 'error');
                });
            } else {
                console.log('ç›´æ¥å•Ÿç”¨æ„Ÿæ‡‰å™¨...');
                showResult('sensor-result', 'âœ… æ„Ÿæ‡‰å™¨å·²å•Ÿç”¨ï¼ˆç„¡éœ€æ¬Šé™ï¼‰', 'success');
                startSensorListen();
            }
        }
        
        function startSensorListen() {
            let count = 0;
            window.addEventListener('devicemotion', function(e) {
                count++;
                if (count === 1) {
                    showResult('sensor-result', 'âœ… æ„Ÿæ‡‰å™¨æ­£å¸¸å·¥ä½œï¼æª¢æ¸¬åˆ°å‹•ä½œæ•¸æ“š', 'success');
                }
                console.log('æ„Ÿæ‡‰å™¨æ•¸æ“š:', e.acceleration);
            });
        }
        
        // é¡¯ç¤ºèª¿è©¦ä¿¡æ¯
        window.onload = function() {
            const debugInfo = document.getElementById('debug-info');
            debugInfo.innerHTML = `
                <strong>ç€è¦½å™¨ä¿¡æ¯ï¼š</strong><br>
                User Agent: ${navigator.userAgent}<br>
                GPSæ”¯æ´: ${!!navigator.geolocation}<br>
                æ„Ÿæ‡‰å™¨æ”¯æ´: ${!!window.DeviceMotionEvent}<br>
                æ„Ÿæ‡‰å™¨éœ€è¦æ¬Šé™: ${typeof DeviceMotionEvent.requestPermission === 'function'}<br>
                HTTPS: ${location.protocol === 'https:'}<br>
                ç•¶å‰URL: ${location.href}<br>
                <br>
                <strong>æ¸¬è©¦æ­¥é©Ÿï¼š</strong><br>
                1. é»æ“Šã€Œæ¸¬è©¦GPSæ¬Šé™ã€æŒ‰éˆ•<br>
                2. ç•¶ç€è¦½å™¨å½ˆå‡ºæ¬Šé™è«‹æ±‚æ™‚ï¼Œé»æ“Šã€Œå…è¨±ã€<br>
                3. é»æ“Šã€Œæ¸¬è©¦æ„Ÿæ‡‰å™¨æ¬Šé™ã€æŒ‰éˆ•<br>
                4. ç•¶ç€è¦½å™¨å½ˆå‡ºæ¬Šé™è«‹æ±‚æ™‚ï¼Œé»æ“Šã€Œå…è¨±ã€<br>
                5. æŸ¥çœ‹çµæœ
            `;
        };
    </script>
</body>
</html>
